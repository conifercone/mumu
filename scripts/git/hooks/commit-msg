#!/bin/sh

# è·å–æäº¤ä¿¡æ¯
commit_message=$(cat "$1")

ignore_pattern="^Merge (tag|branch|pull request)"

# å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŒ¹é… mumu æäº¤è§„èŒƒ
pattern="^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\([a-zA-Z0-9\-_ä¸€-é¾¥ï¼ #\$%&*()+=~\`!?\^|;:'\",.<>/\\\[\]{}\x{4e00}-\x{9fa5}]+\))?: .{0,50}$"

if echo "$commit_message" | grep -P "$ignore_pattern"; then
  echo "â˜€ï¸ This submission does not require verification."
  exit 0
fi

# ä½¿ç”¨ grep -P æ¥æ£€æŸ¥æäº¤ä¿¡æ¯æ˜¯å¦ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼
if ! echo "$commit_message" | grep -P "$pattern"; then
    echo "ğŸŒ¥ï¸ Commit message does not conform to the mumu commit format,Please check the commit_message_template.md file."
    exit 1
fi

echo "ğŸ‰ Commit message checks passed."
