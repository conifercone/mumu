#!/bin/sh

# è·å–æäº¤ä¿¡æ¯
commit_message=$(cat "$1")

# å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŒ¹é… mumu æäº¤è§„èŒƒ
pattern="^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\([a-zA-Z0-9\-_ä¸€-é¾¥]+\))?: [A-Zä¸€-é¾¥].{0,50}"

if ! echo "$commit_message" | grep -qE "$pattern"; then
    echo "ğŸŒ¥ï¸ Commit message does not conform to the mumu commit format."
    echo "Please use the following format: "
    echo "<type>(<scope>): <subject>"
    echo "<BLANK LINE>"
    echo "<body>"
    echo "<BLANK LINE>"
    echo "<footer>"
    echo "Where <type> is one of feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert."
    echo "<scope> may contain Chinese characters and should be lowercase."
    echo "<subject> should start with a capital letter and may contain Chinese characters."
    echo "It should also be a brief description (maximum 50 characters)."
    echo "<type>(<scope>): <subject> part must be included"
    echo "<body>: this is optional, 72-character wrapped. This should answer: Why was this change necessary? How does it address the problem? Are there any side effects?"
    echo "<footer>: this is optional, Include a link to the ticket, if any. eg: Closes #11, contains destructive updates, if any. eg: BREAKING CHANGE: destructive update content"
    exit 1
fi

echo "ğŸ‰ Commit message checks passed."
